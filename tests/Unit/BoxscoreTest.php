<?php
use App\Boxscore;


class BoxscoreTest extends \Codeception\Test\Unit
{
    /**
     * @var \UnitTester
     */
    protected $tester;
    
    protected function _before()
    {
    }

    protected function _after()
    {
    }

    //run only unit tests:  php vendor/bin/codecept run unit
    // run only functional tests:  php vendor/bin/codecept run functional

    public function testAddBoxscore()
    {
        $event_id = '20151027-team-ones-at-team-two';
        $boxscore_date = '2015-10-26T20:00:00-04:00';
        $season_type = 'regular';
        $boxscore_json = '{"away_team": {"city": "Auburn Hills", "state": "Michigan", "active": true, "team_id": "detroit-pistons", "division": "Central", "full_name": "Detroit Pistons", "last_name": "Pistons", "site_name": "The Palace of Auburn Hills", "conference": "East", "first_name": "Detroit", "abbreviation": "DET"}, "home_team": {"city": "Atlanta", "state": "Georgia", "active": true, "team_id": "atlanta-hawks", "division": "Southeast", "full_name": "Atlanta Hawks", "last_name": "Hawks", "site_name": "Philips Arena", "conference": "East", "first_name": "Atlanta", "abbreviation": "ATL"}, "officials": [{"position": null, "last_name": "Roe", "first_name": "Eli"}, {"position": null, "last_name": "Smith", "first_name": "Michael"}, {"position": null, "last_name": "Zarba", "first_name": "Zach"}], "away_stats": [{"blocks": 0, "points": 18, "steals": 0, "assists": 4, "minutes": 37, "position": "PF", "rebounds": 10, "last_name": "Morris", "turnovers": 0, "first_name": "Marcus", "is_starter": true, "display_name": "Marcus Morris", "personal_fouls": 1, "field_goals_made": 6, "free_throws_made": 5, "team_abbreviation": "DET", "defensive_rebounds": 5, "offensive_rebounds": 5, "field_goal_percentage": 0.316, "field_goals_attempted": 19, "free_throw_percentage": 0.833, "free_throws_attempted": 6, "three_point_percentage": 0.25, "field_goal_percentage_string": "31.6", "free_throw_percentage_string": "83.3", "three_point_field_goals_made": 1, "three_point_field_goals_attempted": 4, "three_point_field_goal_percentage_string": "25.0"}, {"blocks": 2, "points": 18, "steals": 1, "assists": 3, "minutes": 37, "position": "C", "rebounds": 19, "last_name": "Drummond", "turnovers": 2, "first_name": "Andre", "is_starter": true, "display_name": "Andre Drummond", "personal_fouls": 4, "field_goals_made": 6, "free_throws_made": 6, "team_abbreviation": "DET", "defensive_rebounds": 11, "offensive_rebounds": 8, "field_goal_percentage": 0.375, "field_goals_attempted": 16, "free_throw_percentage": 0.6, "free_throws_attempted": 10, "three_point_percentage": 0, "field_goal_percentage_string": "37.5", "free_throw_percentage_string": "60.0", "three_point_field_goals_made": 0, "three_point_field_goals_attempted": 0, "three_point_field_goal_percentage_string": "&mdash;"}, {"blocks": 0, "points": 21, "steals": 1, "assists": 1, "minutes": 37, "position": "SG", "rebounds": 4, "last_name": "Caldwell-Pope", "turnovers": 2, "first_name": "Kentavious", "is_starter": true, "display_name": "Kentavious Caldwell-Pope", "personal_fouls": 1, "field_goals_made": 7, "free_throws_made": 3, "team_abbreviation": "DET", "defensive_rebounds": 3, "offensive_rebounds": 1, "field_goal_percentage": 0.5, "field_goals_attempted": 14, "free_throw_percentage": 1, "free_throws_attempted": 3, "three_point_percentage": 0.571, "field_goal_percentage_string": "50.0", "free_throw_percentage_string": "100.0", "three_point_field_goals_made": 4, "three_point_field_goals_attempted": 7, "three_point_field_goal_percentage_string": "57.1"}, {"blocks": 1, "points": 16, "steals": 0, "assists": 3, "minutes": 34, "position": "PF", "rebounds": 7, "last_name": "Ilyasova", "turnovers": 3, "first_name": "Ersan", "is_starter": true, "display_name": "Ersan Ilyasova", "personal_fouls": 4, "field_goals_made": 6, "free_throws_made": 1, "team_abbreviation": "DET", "defensive_rebounds": 4, "offensive_rebounds": 3, "field_goal_percentage": 0.5, "field_goals_attempted": 12, "free_throw_percentage": 0.5, "free_throws_attempted": 2, "three_point_percentage": 0.5, "field_goal_percentage_string": "50.0", "free_throw_percentage_string": "50.0", "three_point_field_goals_made": 3, "three_point_field_goals_attempted": 6, "three_point_field_goal_percentage_string": "50.0"}, {"blocks": 0, "points": 15, "steals": 2, "assists": 5, "minutes": 32, "position": "PG", "rebounds": 8, "last_name": "Jackson", "turnovers": 2, "first_name": "Reggie", "is_starter": true, "display_name": "Reggie Jackson", "personal_fouls": 0, "field_goals_made": 4, "free_throws_made": 5, "team_abbreviation": "DET", "defensive_rebounds": 7, "offensive_rebounds": 1, "field_goal_percentage": 0.4, "field_goals_attempted": 10, "free_throw_percentage": 1, "free_throws_attempted": 5, "three_point_percentage": 0.5, "field_goal_percentage_string": "40.0", "free_throw_percentage_string": "100.0", "three_point_field_goals_made": 2, "three_point_field_goals_attempted": 4, "three_point_field_goal_percentage_string": "50.0"}, {"blocks": 0, "points": 7, "steals": 0, "assists": 3, "minutes": 24, "position": "SF", "rebounds": 4, "last_name": "Johnson", "turnovers": 1, "first_name": "Stanley", "is_starter": false, "display_name": "Stanley Johnson", "personal_fouls": 1, "field_goals_made": 3, "free_throws_made": 0, "team_abbreviation": "DET", "defensive_rebounds": 1, "offensive_rebounds": 3, "field_goal_percentage": 0.3, "field_goals_attempted": 10, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0.333, "field_goal_percentage_string": "30.0", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 1, "three_point_field_goals_attempted": 3, "three_point_field_goal_percentage_string": "33.3"}, {"blocks": 0, "points": 3, "steals": 1, "assists": 4, "minutes": 16, "position": "PG", "rebounds": 0, "last_name": "Blake", "turnovers": 3, "first_name": "Steve", "is_starter": false, "display_name": "Steve Blake", "personal_fouls": 1, "field_goals_made": 1, "free_throws_made": 0, "team_abbreviation": "DET", "defensive_rebounds": 0, "offensive_rebounds": 0, "field_goal_percentage": 0.167, "field_goals_attempted": 6, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0.2, "field_goal_percentage_string": "16.7", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 1, "three_point_field_goals_attempted": 5, "three_point_field_goal_percentage_string": "20.0"}, {"blocks": 0, "points": 2, "steals": 0, "assists": 0, "minutes": 11, "position": "SG", "rebounds": 2, "last_name": "Meeks", "turnovers": 1, "first_name": "Jodie", "is_starter": false, "display_name": "Jodie Meeks", "personal_fouls": 1, "field_goals_made": 1, "free_throws_made": 0, "team_abbreviation": "DET", "defensive_rebounds": 1, "offensive_rebounds": 1, "field_goal_percentage": 0.25, "field_goals_attempted": 4, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0, "field_goal_percentage_string": "25.0", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 0, "three_point_field_goals_attempted": 0, "three_point_field_goal_percentage_string": "&mdash;"}, {"blocks": 0, "points": 6, "steals": 0, "assists": 0, "minutes": 11, "position": "PF", "rebounds": 5, "last_name": "Baynes", "turnovers": 1, "first_name": "Aron", "is_starter": false, "display_name": "Aron Baynes", "personal_fouls": 2, "field_goals_made": 3, "free_throws_made": 0, "team_abbreviation": "DET", "defensive_rebounds": 4, "offensive_rebounds": 1, "field_goal_percentage": 0.6, "field_goals_attempted": 5, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0, "field_goal_percentage_string": "60.0", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 0, "three_point_field_goals_attempted": 0, "three_point_field_goal_percentage_string": "&mdash;"}], "home_stats": [{"blocks": 0, "points": 19, "steals": 0, "assists": 3, "minutes": 36, "position": "PF", "rebounds": 8, "last_name": "Millsap", "turnovers": 2, "first_name": "Paul", "is_starter": true, "display_name": "Paul Millsap", "personal_fouls": 4, "field_goals_made": 7, "free_throws_made": 3, "team_abbreviation": "ATL", "defensive_rebounds": 7, "offensive_rebounds": 1, "field_goal_percentage": 0.467, "field_goals_attempted": 15, "free_throw_percentage": 0.75, "free_throws_attempted": 4, "three_point_percentage": 0.333, "field_goal_percentage_string": "46.7", "free_throw_percentage_string": "75.0", "three_point_field_goals_made": 2, "three_point_field_goals_attempted": 6, "three_point_field_goal_percentage_string": "33.3"}, {"blocks": 0, "points": 18, "steals": 0, "assists": 4, "minutes": 32, "position": "PG", "rebounds": 2, "last_name": "Teague", "turnovers": 5, "first_name": "Jeff", "is_starter": true, "display_name": "Jeff Teague", "personal_fouls": 1, "field_goals_made": 7, "free_throws_made": 3, "team_abbreviation": "ATL", "defensive_rebounds": 2, "offensive_rebounds": 0, "field_goal_percentage": 0.438, "field_goals_attempted": 16, "free_throw_percentage": 0.75, "free_throws_attempted": 4, "three_point_percentage": 0.333, "field_goal_percentage_string": "43.8", "free_throw_percentage_string": "75.0", "three_point_field_goals_made": 1, "three_point_field_goals_attempted": 3, "three_point_field_goal_percentage_string": "33.3"}, {"blocks": 3, "points": 15, "steals": 2, "assists": 4, "minutes": 30, "position": "PF", "rebounds": 4, "last_name": "Horford", "turnovers": 1, "first_name": "Al", "is_starter": true, "display_name": "Al Horford", "personal_fouls": 1, "field_goals_made": 6, "free_throws_made": 2, "team_abbreviation": "ATL", "defensive_rebounds": 3, "offensive_rebounds": 1, "field_goal_percentage": 0.545, "field_goals_attempted": 11, "free_throw_percentage": 0.667, "free_throws_attempted": 3, "three_point_percentage": 0.333, "field_goal_percentage_string": "54.5", "free_throw_percentage_string": "66.7", "three_point_field_goals_made": 1, "three_point_field_goals_attempted": 3, "three_point_field_goal_percentage_string": "33.3"}, {"blocks": 0, "points": 7, "steals": 1, "assists": 1, "minutes": 29, "position": "SG", "rebounds": 2, "last_name": "Korver", "turnovers": 1, "first_name": "Kyle", "is_starter": true, "display_name": "Kyle Korver", "personal_fouls": 4, "field_goals_made": 3, "free_throws_made": 0, "team_abbreviation": "ATL", "defensive_rebounds": 2, "offensive_rebounds": 0, "field_goal_percentage": 0.333, "field_goals_attempted": 9, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0.2, "field_goal_percentage_string": "33.3", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 1, "three_point_field_goals_attempted": 5, "three_point_field_goal_percentage_string": "20.0"}, {"blocks": 0, "points": 0, "steals": 0, "assists": 1, "minutes": 21, "position": "SG", "rebounds": 7, "last_name": "Bazemore", "turnovers": 4, "first_name": "Kent", "is_starter": true, "display_name": "Kent Bazemore", "personal_fouls": 3, "field_goals_made": 0, "free_throws_made": 0, "team_abbreviation": "ATL", "defensive_rebounds": 7, "offensive_rebounds": 0, "field_goal_percentage": 0, "field_goals_attempted": 3, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0, "field_goal_percentage_string": "0.0", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 0, "three_point_field_goals_attempted": 1, "three_point_field_goal_percentage_string": "0.0"}, {"blocks": 0, "points": 20, "steals": 2, "assists": 4, "minutes": 25, "position": "PG", "rebounds": 3, "last_name": "Schröder", "turnovers": 1, "first_name": "Dennis", "is_starter": false, "display_name": "Dennis Schröder", "personal_fouls": 1, "field_goals_made": 8, "free_throws_made": 2, "team_abbreviation": "ATL", "defensive_rebounds": 2, "offensive_rebounds": 1, "field_goal_percentage": 0.571, "field_goals_attempted": 14, "free_throw_percentage": 1, "free_throws_attempted": 2, "three_point_percentage": 0.4, "field_goal_percentage_string": "57.1", "free_throw_percentage_string": "100.0", "three_point_field_goals_made": 2, "three_point_field_goals_attempted": 5, "three_point_field_goal_percentage_string": "40.0"}, {"blocks": 0, "points": 2, "steals": 4, "assists": 3, "minutes": 19, "position": "SG", "rebounds": 7, "last_name": "Sefolosha", "turnovers": 0, "first_name": "Thabo", "is_starter": false, "display_name": "Thabo Sefolosha", "personal_fouls": 1, "field_goals_made": 1, "free_throws_made": 0, "team_abbreviation": "ATL", "defensive_rebounds": 6, "offensive_rebounds": 1, "field_goal_percentage": 0.333, "field_goals_attempted": 3, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0, "field_goal_percentage_string": "33.3", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 0, "three_point_field_goals_attempted": 1, "three_point_field_goal_percentage_string": "0.0"}, {"blocks": 0, "points": 5, "steals": 0, "assists": 2, "minutes": 18, "position": "SG", "rebounds": 1, "last_name": "Patterson", "turnovers": 0, "first_name": "Lamar", "is_starter": false, "display_name": "Lamar Patterson", "personal_fouls": 4, "field_goals_made": 1, "free_throws_made": 2, "team_abbreviation": "ATL", "defensive_rebounds": 1, "offensive_rebounds": 0, "field_goal_percentage": 1, "field_goals_attempted": 1, "free_throw_percentage": 1, "free_throws_attempted": 2, "three_point_percentage": 1, "field_goal_percentage_string": "100.0", "free_throw_percentage_string": "100.0", "three_point_field_goals_made": 1, "three_point_field_goals_attempted": 1, "three_point_field_goal_percentage_string": "100.0"}, {"blocks": 1, "points": 4, "steals": 0, "assists": 0, "minutes": 16, "position": "PF", "rebounds": 4, "last_name": "Splitter", "turnovers": 0, "first_name": "Tiago", "is_starter": false, "display_name": "Tiago Splitter", "personal_fouls": 4, "field_goals_made": 2, "free_throws_made": 0, "team_abbreviation": "ATL", "defensive_rebounds": 1, "offensive_rebounds": 3, "field_goal_percentage": 0.4, "field_goals_attempted": 5, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0, "field_goal_percentage_string": "40.0", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 0, "three_point_field_goals_attempted": 0, "three_point_field_goal_percentage_string": "&mdash;"}, {"blocks": 0, "points": 0, "steals": 0, "assists": 0, "minutes": 8, "position": "PF", "rebounds": 1, "last_name": "Muscala", "turnovers": 1, "first_name": "Michael", "is_starter": false, "display_name": "Mike Muscala", "personal_fouls": 2, "field_goals_made": 0, "free_throws_made": 0, "team_abbreviation": "ATL", "defensive_rebounds": 1, "offensive_rebounds": 0, "field_goal_percentage": 0, "field_goals_attempted": 1, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0, "field_goal_percentage_string": "0.0", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 0, "three_point_field_goals_attempted": 0, "three_point_field_goal_percentage_string": "&mdash;"}, {"blocks": 0, "points": 4, "steals": 0, "assists": 0, "minutes": 5, "position": "PF", "rebounds": 1, "last_name": "Scott", "turnovers": 0, "first_name": "James", "is_starter": false, "display_name": "Mike Scott", "personal_fouls": 0, "field_goals_made": 2, "free_throws_made": 0, "team_abbreviation": "ATL", "defensive_rebounds": 1, "offensive_rebounds": 0, "field_goal_percentage": 0.5, "field_goals_attempted": 4, "free_throw_percentage": 0, "free_throws_attempted": 0, "three_point_percentage": 0, "field_goal_percentage_string": "50.0", "free_throw_percentage_string": "&mdash;", "three_point_field_goals_made": 0, "three_point_field_goals_attempted": 2, "three_point_field_goal_percentage_string": "0.0"}], "away_totals": {"blocks": 3, "points": 106, "steals": 5, "assists": 23, "minutes": 239, "rebounds": 59, "turnovers": 15, "personal_fouls": 15, "field_goals_made": 37, "free_throws_made": 20, "defensive_rebounds": 36, "offensive_rebounds": 23, "field_goal_percentage": 0.385, "field_goals_attempted": 96, "free_throw_percentage": 0.769, "free_throws_attempted": 26, "three_point_percentage": 0.414, "field_goal_percentage_string": "38.5", "free_throw_percentage_string": "76.9", "three_point_field_goals_made": 12, "three_point_field_goals_attempted": 29, "three_point_field_goal_percentage_string": "41.4"}, "home_totals": {"blocks": 4, "points": 94, "steals": 9, "assists": 22, "minutes": 239, "rebounds": 40, "turnovers": 15, "personal_fouls": 25, "field_goals_made": 37, "free_throws_made": 12, "defensive_rebounds": 33, "offensive_rebounds": 7, "field_goal_percentage": 0.451, "field_goals_attempted": 82, "free_throw_percentage": 0.8, "free_throws_attempted": 15, "three_point_percentage": 0.296, "field_goal_percentage_string": "45.1", "free_throw_percentage_string": "80.0", "three_point_field_goals_made": 8, "three_point_field_goals_attempted": 27, "three_point_field_goal_percentage_string": "29.6"}, "event_information": {"site": {"city": "Atlanta", "name": "Philips Arena", "state": "Georgia", "surface": "Hardwood", "capacity": 20300}, "duration": "2:10", "attendance": 19187, "season_type": "regular", "temperature": 0, "event_status": "completed", "start_date_time": "2015-10-27T20:00:00-04:00"}, "away_period_scores": [25, 23, 34, 24], "home_period_scores": [25, 18, 23, 28]}';
        $boxscore_json= json_decode( json_encode($boxscore_json), true);

        $testBox = new Boxscore([
            'event_id' => $event_id,
            'boxscore_date' => $boxscore_date,
            'season_type' => $season_type,
            'boxscore_json' => $boxscore_json
        ]);

        $testBox->save();

        $this->tester->seeRecord('boxscores', [ 'event_id' => $event_id, 'boxscore_date' => $boxscore_date, 'season_type' => $season_type, 'boxscore_json' => $boxscore_json ]);
    }
}